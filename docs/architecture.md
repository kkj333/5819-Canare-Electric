# アーキテクチャ

## 設計思想

このプロジェクトのレポートは「読み物」ではなく、**投資判断のためのインサイトDB**である。

### ファイルの役割

| ファイル | 目的 | 主な利用者 |
|---|---|---|
| `report.md` | AI が生成・更新するインサイトDB | 生成AI（書き手） |
| `report.html` | 検証用ビューア | 人間 + レビューAI（検査役） |
| `chart_config.json` | チャート定義 | build_report.py |

### report.md

- 分析順序（ボトムアップ: 事実→分析→結論）で構造化
- AI が読み書きしやすいことを最優先。見た目の最適化は非目的
- `/update-report`、`/update-price` で継続的に更新される生きたドキュメント

### report.html

- `report.md` + `chart_config.json` から `build_report.py` が決定的に生成
- 人間と別のAIが「この数字おかしくない？」をクロスチェックするためのUI
- サイドバーTOCで任意セクションに直接アクセスできるため、セクション順序の最適化は不要
- HTMLの体裁改善より、インサイトの質と数値精度を優先すること

## ワークフロー

```
EDINET/PDF → AI分析 → report.md → 人間+AIが検証 → AI再更新 → ...
```

生成AIとレビューAIは別のコンテキストで動作する。同じソースを異なる形式（MD/HTML）で見ることで、生成時のバイアスや見落としを検出しやすくなる。

## build_report.py

- **AI判断は含まない。決定的な変換処理のみ**
- Markdown→HTML変換、チャート挿入、TOC生成を行う
- セクション順序の並べ替えや内容の加工はしない
